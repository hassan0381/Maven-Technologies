---
import MainLayout from "../layouts/main-layout.astro";
import Button from '../components/button.tsx'
import ChevronRight from "../icons/chevron-right.jsx";
import { getSinglePage } from "../lib/contentParser.astro";

export async function getStaticPaths() {
  const pages = await getSinglePage("pages");
  const allPages = [...pages];

  const paths = allPages.map((page:any) => ({
    params: {regular: page.slug,},
    props: { page },
  }));
  return paths;
}
const { page } = Astro.props;
const {Content} = await page.render();
const { 
  title, category_name, category_url, heading, sub_heading, 
  heroimage, value_prop, case_studies_heading, 
  case_studies_subheading, case_studies_description, case_studies_category, 
  case_studies_items, videosection_videotitle, 
  videosection_videourl, videosection_heroimage, 
  related_articles_heading, related_articles_subheading, 
  related_articles_description, related_articles_category, 
  related_articles_items
} = page.data;
const banner_style = {
    backgroundImage:
        "url('"+heroimage+"')",
    minHeight: "50vh",
    width: "100%",            
    backgroundSize: "cover",
    backgroundRepeat: "no-repeat",
};
const video_section_style = {
  backgroundImage:
        "url('"+videosection_heroimage+"')",
    width: "100%",       
    minHeight: "35vh",
    padding: "5vmin",
    alignItems: "center",
    justifyContent: "center",
    backgroundSize: "cover",
    backgroundRepeat: "no-repeat"
};
const sub_heading_display = sub_heading.toUpperCase()
const videosection_description = "Content to be added";
console.log(page.data);
---

<MainLayout title={title}>
  <section class="section">  
    <div class="detailedpage_banner_topper">
      <div class="detailedpage_banner_topper_categoryheading">
        <a href={category_url}>{category_name.toUpperCase()}</a>
      </div>
      <div class="detailedpage_banner_topper_mainheading">
        <p>{title}</p>
      </div>
    </div>
    <div style={banner_style} >
      <div class="grid grid-cols-12 gap-4">
        <div class="col-span-1"/>
        <div class="col-span-10">
          <div class="detailedpage_banner_heading_container">
            <div class="detailedpage_banner_headingbackground">
              <div class="detailedpage_banner_subheading">
                <p>{sub_heading_display}</p>
              </div>
              <div class="detailedpage_banner_heading">
                <h1>{heading}</h1>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>
  <section class="section">
    <!-- <div class="detailedpage_valueprop">    
        <p>{value_prop}</p>    
    </div> -->
    <div class="content mb-16 text-left">
      <div class="grid grid-cols-12 gap-4">
        <div class="col-span-2"/>
        <div class="col-span-8">
          <Content />          
        </div>
        <div class="col-span-2"/>
      </div>
    </div>
  </section>
  <section class="section">
    <div class="detailedpage_recentnews_container">
      <div class="detailedpage_recentnews_container">
        <div class="detailedpage_recentnews_subheading">
          {case_studies_subheading.toUpperCase()}          
        </div>  
        <div class="detailedpage_recentnews_heading">
          <h2>{case_studies_heading}</h2>
        </div> 
        <div class="detailedpage_recentnews_description">
          <p>{case_studies_description}</p>
        </div>
      </div>
    </div>
    <div class="detailedpage_casestudies_items_container">
      <div>
        {
          case_studies_items.map((item:any, index:any) => (            
            <div class="grid grid-cols-6 gap-2 detailedpage_casestudiesitem_container">                
              <div class="col-span-6  detailedpage_casestudiesitem_subheading">
                {item.case_study_subheading.toUpperCase()}
              </div>
              <div class="col-span-6 detailedpage_recentnewsitem_image">
                <img src={item.case_study_image} />                  
              </div> 
              <div class="col-span-6  detailedpage_casestudiesitem_heading">
                {item.case_study_title}
              </div>
              <div class="col-span-6">
                <div class="grid grid-cols-2 gap-2">
                  <div class="col-span-1"/>
                  <div class="col-span-1">
                    <Button text={item.case_study_buttontext} href={"../casestudies/"+ item.case_study_slug} color="#505050"/>
                  </div>
                </div>
              </div>                            
            </div>
          ))
        }
      </div>  
    </div>
  </section>
  <section class="section">
    <div style={video_section_style}>
      <div class="grid grid-cols-2 gap-4 detailedpage_video_container">      
        <div class="col-span-1">
          <div class="detailedpage_video_heading">
            <h2>{videosection_videotitle}</h2>
          </div>
          <div class="detailedpage_video_description">
            {videosection_description}
          </div>
        </div>
        <div class="col-span-1">
          <div class="detailedpage_videosection">
            <iframe width="420" height="315" src={videosection_videourl} />
          </div>
        </div>
      </div>
    </div>
  </section>
  <section class="section">
    <div class="detailedpage_recentnews_container">
      <div class="detailedpage_recentnews_container">
        <div class="detailedpage_recentnews_subheading">
          {related_articles_subheading.toUpperCase()}          
        </div>  
        <div class="detailedpage_recentnews_heading">
          <h2>{related_articles_heading}</h2>
        </div> 
        <div class="detailedpage_recentnews_description">
          <p>{related_articles_description}</p>
        </div>
      </div>
    </div>
    <div class="detailedpage_casestudies_items_container">
      <div>
        {
          related_articles_items.map((item:any, index:any) => (
            
            <a href={"../pulse/"+ item.related_article_slug}>
              <div class="grid grid-cols-6 gap-2 detailedpage_casestudiesitem_container">                
                <div class="col-span-6  detailedpage_casestudiesitem_subheading">
                  {item.related_article_subheading.toUpperCase()}
                </div>
                <div class="col-span-6 detailedpage_recentnewsitem_image">
                  <img src={item.related_article_image} />                  
                </div> 
                <div class="col-span-6  detailedpage_casestudiesitem_heading">
                  {item.related_article_title}
                </div>
                <div class="col-span-6">
                  <div class="grid grid-cols-2 gap-2">
                    <div class="col-span-1"/>
                    <div class="col-span-1">
                      <Button text={item.related_article_buttontext} href={"../pulse/"+ item.related_article_slug} color="#505050" />
                    </div>
                  </div>
                </div>                            
              </div>
            </a>
          ))
        }
      </div>  
    </div>
  </section>
  
</MainLayout>
